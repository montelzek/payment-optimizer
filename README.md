The algorithm works in 5 steps:
1. First it tries to pay the full amount with loyalty points
2. If it can't with points, it looks for the best bank promotion
3. When there is no promotion, pays partially with points and the rest with the card
4. If there is a shortage of points, he uses as many points as he can (without discount), and pays the rest with his card.
5. Finally, if nothing else works, he pays the whole thing with any card without a discount.
